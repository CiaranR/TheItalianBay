
from google.appengine.ext import webapp
from google.appengine.ext.webapp import util
from google.appengine.ext.webapp import template

from settings import TEMPLATE_PATH
from libs.PirateBayAPI import PirateBayAPI

# GET /
class RootHandler(webapp.RequestHandler):
    def get(self):
        self.response.out.write(template.render(TEMPLATE_PATH + 'index.html', {}))

# GET /requestResultsForValue?value=spider+man&filter=video
class RequestResultsForValueHandler(webapp.RequestHandler):
    def get(self):
        value = "Inception"
        results = [{'permalink': u'/torrent/5921876/Inception_(2010)_DVDRip_XviD-MAX', 'LE': u'1775', 'SE': u'6694', 'title': u'Inception (2010) DVDRip XviD-MAX'}, {'permalink': u'/torrent/5922975/Inception[2010]DvDrip[Eng]-FXG', 'LE': u'240', 'SE': u'1199', 'title': u'Inception[2010]DvDrip[Eng]-FXG'}, {'permalink': u'/torrent/5933841/Inception_[2010]_DvDRiP_XviD_-_ExtraTorrentRG', 'LE': u'57', 'SE': u'829', 'title': u'Inception [2010] DvDRiP XviD - ExtraTorrentRG'}, {'permalink': u'/torrent/5960064/Inception.1080p.BluRay.x264-REFiNED', 'LE': u'491', 'SE': u'825', 'title': u'Inception.1080p.BluRay.x264-REFiNED'}, {'permalink': u'/torrent/5958692/Inception.720p.BluRay.x264-CROSSBOW', 'LE': u'208', 'SE': u'645', 'title': u'Inception.720p.BluRay.x264-CROSSBOW'}, {'permalink': u'/torrent/5728485/Inception.2010.TS.XVID-PrisM', 'LE': u'26', 'SE': u'622', 'title': u'Inception.2010.TS.XVID-PrisM'}, {'permalink': u'/torrent/5924358/Inception_-_French_-_DVDRip_-_XviD_-_1CDRip_-_[DDR]', 'LE': u'85', 'SE': u'307', 'title': u'Inception - French - DVDRip - XviD - 1CDRip - [DDR]'}, {'permalink': u'/torrent/5688769/Inception_-_Hans_Zimmer_[Soundtrack]_[Score]_[OST]_[2010_MP3_320', 'LE': u'24', 'SE': u'297', 'title': u'Inception - Hans Zimmer [Soundtrack] [Score] [OST] [2010/MP3/320'}, {'permalink': u'/torrent/5710122/Inception.2010.CAM.XviD-TA(NEW_SOURCE)', 'LE': u'27', 'SE': u'226', 'title': u'Inception.2010.CAM.XviD-TA(NEW SOURCE)'}, {'permalink': u'/torrent/5921676/Inception.DVDRiP.XviD-ARROW', 'LE': u'39', 'SE': u'221', 'title': u'Inception.DVDRiP.XviD-ARROW'}, {'permalink': u'/torrent/5924295/Inception_(2010)_dvdr_(Nl_Eng_Esp_sub)_ZARCK_2Lions-Team', 'LE': u'18', 'SE': u'212', 'title': u'Inception (2010) dvdr (Nl+Eng+Esp sub) ZARCK 2Lions-Team'}, {'permalink': u'/torrent/6099836/Inception_2010_XviD_DvDrip[Eng]-greenbud1969', 'LE': u'22', 'SE': u'202', 'title': u'Inception 2010 XviD DvDrip[Eng]-greenbud1969'}, {'permalink': u'/torrent/6399918/Inception_(2010)_BRRip_720p_x264_5.1ch_AAC-Ameet6233', 'LE': u'92', 'SE': u'186', 'title': u'Inception (2010) BRRip 720p x264 5.1ch AAC-Ameet6233'}, {'permalink': u'/torrent/6076135/Inception_(2010)_DvDrip__xvid', 'LE': u'6', 'SE': u'181', 'title': u'Inception (2010) DvDrip, xvid'}, {'permalink': u'/torrent/5932659/Inception_(PSP__iPod__Zune)', 'LE': u'11', 'SE': u'125', 'title': u'Inception (PSP, iPod, Zune)'}, {'permalink': u'/torrent/6002603/Inception.2010.SWESUB.DVDRip.XviD-ReGeN', 'LE': u'6', 'SE': u'119', 'title': u'Inception.2010.SWESUB.DVDRip.XviD-ReGeN'}, {'permalink': u'/torrent/5962860/Inception_2010_BRRip_720p_H264_AAC_-_SecretMyth_(Kingdom-Release', 'LE': u'61', 'SE': u'117', 'title': u'Inception 2010 BRRip 720p H264 AAC - SecretMyth (Kingdom-Release'}, {'permalink': u'/torrent/6029155/Inception__2010__[BluRay][1080p][ENG__POL]', 'LE': u'54', 'SE': u'115', 'title': u'Inception *2010* [BluRay][1080p][ENG, POL]'}, {'permalink': u'/torrent/5901367/Inception.2010.iTALiAN.MD.TS.XviD-FREE_[IDN_CREW]', 'LE': u'5', 'SE': u'89', 'title': u'Inception.2010.iTALiAN.MD.TS.XviD-FREE [IDN CREW]'}, {'permalink': u'/torrent/6217536/INCEPTION_DVD_RIP', 'LE': u'3', 'SE': u'67', 'title': u'INCEPTION DVD RIP'}, {'permalink': u'/torrent/5719404/Inception.2010.CAM.H264-CRYS', 'LE': u'0', 'SE': u'59', 'title': u'Inception.2010.CAM.H264-CRYS'}, {'permalink': u'/torrent/5922205/Inception_2010_DvDRip_H264_CRYS', 'LE': u'18', 'SE': u'59', 'title': u'Inception 2010 DvDRip H264 CRYS'}, {'permalink': u'/torrent/6059134/Inception_2010.480p.Dual-Audio_Hindi-Eng_BRRip.aaaevilacharya', 'LE': u'27', 'SE': u'59', 'title': u'Inception 2010.480p.Dual-Audio{Hindi-Eng}BRRip.aaaevilacharya'}, {'permalink': u'/torrent/6172503/(DivX-ITA)_Inception_(BR-RIP)', 'LE': u'9', 'SE': u'59', 'title': u'(DivX-ITA) Inception (BR-RIP)'}, {'permalink': u'/torrent/5967129/Inception.2010.BRRiP_5.1_720p.x264_PlutO_', 'LE': u'5', 'SE': u'56', 'title': u'Inception.2010.BRRiP_5.1_720p.x264~PlutO~'}, {'permalink': u'/torrent/5827711/Inception_(2010)_TS_NL_Sub_NLT-Release_(divx)_luiehond69_', 'LE': u'1', 'SE': u'55', 'title': u'Inception (2010) TS NL Sub NLT-Release (divx){luiehond69}'}, {'permalink': u'/torrent/6011066/INCEPTION_2010_BluRay_720p_QEBS_AAC_MP4_PS3-FASM', 'LE': u'10', 'SE': u'54', 'title': u'INCEPTION 2010 BluRay 720p QEBS AAC MP4 PS3-FASM'}, {'permalink': u'/torrent/5923681/Inception.FRENCH.REPACK.1CD.DVDRiP.XViD_ITOMA.[cvsj]', 'LE': u'1', 'SE': u'53', 'title': u'Inception.FRENCH.REPACK.1CD.DVDRiP.XViD_ITOMA.[cvsj]'}, {'permalink': u'/torrent/6057117/Inception_COMPLETE_DVD_Rip_by_vladtepes3176', 'LE': u'9', 'SE': u'52', 'title': u'Inception COMPLETE DVD Rip by vladtepes3176'}, {'permalink': u'/torrent/5933787/Inception.2010.DVDRiP.XviD.SWESUB-Zen_Bud', 'LE': u'2', 'SE': u'51', 'title': u'Inception.2010.DVDRiP.XviD.SWESUB-Zen_Bud'}]
        self.response.out.write(template.render(TEMPLATE_PATH + 'search-results.html', {'results' : results, 'original_query' : value}))

def main():
    application = webapp.WSGIApplication([('/', RootHandler), ('/requestResultsForValue', RequestResultsForValueHandler)],
                                         debug=False)
    util.run_wsgi_app(application)


if __name__ == '__main__':
    main()
